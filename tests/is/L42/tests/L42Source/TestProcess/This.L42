reuse [AdamsTowel]

Secret = {...}//THIS FILE IS NOT COMMITTED. You have to fill it with you git access token, as in
//class method S #$of()=S"ghp_..."
GW = Load:{reuse[L42.is/GitWriter]}
LoadDeploy = Load:{reuse[L42.is/Deploy]}
DeployGit = LoadDeploy.with(writer=GW)
ProcessLib = Trait:{...}
TaskDeploy = DeployGit.module(ProcessLib['Process$Real=>'Process.Real; hide='Process.Result(that)]
  name='Process
  on=Url"github.com/%Secret.repo()/%Secret.version()/Process.L42",
  writer=GW.#$of(
    token=Secret.#$of(),
    message=S"Process automatic release 42V"++Secret.version()
  ))

Process = Load:{reuse[#$L42.is/Process]}
CanNotBeTestesSystemIndependently=(
    (
    pLinux=Process.Real.#$of(\[S"ls";S"-l"])
    res=pLinux.start(input=S"")
    catch Process.Fail f void
    {}:Test""(res.out().size()>5I)
    {}:Test""(res.err()==S"")
    )(
    pWin=Process.Real.#$of(\[S"cmd";S"/c";S"dir"])
    res=pWin.start(input=S"")
    catch Process.Fail f void
    {}:Test""(res.out().size()>5I)
    {}:Test""(res.err()==S"")    
    )
  //p0=Process.Real.#$of(\[S"bash"])
  //res=p.start(input=S"")
  //Debug(res)
  //res0=p0.start(input=S"ls -l")
  //Debug(res0)
  //On linux, they should get the same output
  //{}:Test"done"(Bool.true())
  )

DeployDocs = (
  //m4 -P Doc.c > Doc.xhtml
  /*command for linux/mac*/
  Process.Result res={
    return Process.Real.#$of(\[S"m4";S"-P";S"Doc.c"]).start(input=S"")
    catch Process.Fail f (
      /*command for win*/
      return Process.Real.#$of(\[S"../CommonHtmlDocumentation/m4.exe";S"-P";S"Doc.c"]).start(input=S"")  
      )
    }
  Debug(S"err is %res.err()")
  overview=Info(Process).toFullS()
  content=res.out().replace(S"[OVERVIEW_HERE]" with=overview)
  writer = GW.#$of(
    token=Secret.#$of(),
    message=S"Process automatic release 42V"++Secret.version()
    )
  writer.write(
    on=Url"github.com/%Secret.repo()/%Secret.version()/Process.xhtml",
    contentBase64=content.encodeBase64() 
    )
  )