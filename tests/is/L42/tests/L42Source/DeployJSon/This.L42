reuse [AdamsTowel]
JsonLibTrait = Trait:{reuse [AdamsTowel]
  Json=Organize:{
    Parse = Trait:{...}
    JsonBase = Trait:{...}
    JsonSeal = Trait:{...}
    ToJson =(JsonSeal:Organize:{...})[hide='Value.sealed()]
    $ = Class:ToJson
    ParseJson = Public:Class:Parse:{...}
    class method $.Value #from(S.StringBuilder stringLiteral) = ParseJson(stringLiteral.toS())
    }
  }
Json = Load:Class.Relax:System.extractModule(JsonLibTrait.code(),name='Json)

TestJSon = (
  Json.Value v=Json"""
    |[{ "a":12, "b":true, "c":["a","k"] },
    |" hello ",
    | 123456,
    |-123456,
    |" \n foo \uAABB hi! "
    |]
    """
  {}:Test""(actual=v, expected=S"""
    |[{a->12; b->True; c->[a; k]};  hello ; 123456; -123456;  \n foo \uAABB hi! ]
    """.trim())
  {}:Test""(actual=v.toJson(), expected=S"""
    |[{"a": 12, "b": true, "c": ["a", "k"]}, " hello ", 123456, -123456, " \n foo \uAABB hi! "]
    """.trim())
  )


Secret = {...}//THIS FILE IS NOT COMMITTED. You have to fill it with you git access token, as in
//class method S #$of()=S"ghp_..."
GW = Load:{reuse[L42.is/GitWriter]}
LoadDeploy = Load:{reuse[L42.is/Deploy]}
DeployGit = LoadDeploy.with(writer=GW)

Deployed = DeployGit.module(JsonLibTrait()
  name='Json
  on=Url"github.com/%Secret.repo()/%Secret.version()/Json.L42",
  writer=GW.#$of(
    token=Secret.#$of(),
    message=S"Test library Json parser automatic release 42 "++Secret.version()
  ))

JS=Load:{reuse [#$L42.is/Json]}
TestJSonDeployed = (
  JS.Value v=JS"""
    |[{ "a":12, "b":true, "c":["a","k"] },
    |" hello ",
    | 123456,
    |-123456,
    |" \n foo \uAABB hi! "
    |]
    """
  {}:Test""(actual=v, expected=S"""
    |[{a->12; b->True; c->[a; k]};  hello ; 123456; -123456;  \n foo \uAABB hi! ]
    """.trim())
  {}:Test""(actual=v.toJson(), expected=S"""
    |[{"a": 12, "b": true, "c": ["a", "k"]}, " hello ", 123456, -123456, " \n foo \uAABB hi! "]
    """.trim())
  )


/*
value::= object | array | string | number | "true" | "false" | "null"
object::= '{' ws members '}' ///why this instead of ws in members
members::=member | member ',' ws members
member::= string ws ':' element
array::='[' ws elements ']'
elements::= element | element ',' ws elements
element::= ws value ws
string::= '"' characters '"'
characters::=""| character characters
character::= '0020' . '10FFFF' - '"' - '\' | '\' escape
escape::='"'|'\'|'/'|'b'|'f'|'n'|'r'|'t'|'u' hex hex hex hex
hex::=digit | 'A' . 'F' | 'a' . 'f'
number::= integer fraction exponent
integer::= digit | onenine digits | '-' digit | '-' onenine digits
digits::= digit | digit digits
digit::= '0' | onenine
onenine ::= '1' . '9'
fraction ::= "" | '.' digits
exponent ::= "" | 'E' sign digits | 'e' sign digits
sign ::= "" | '+' | '-'
ws::="" | '0020' ws | '000A' ws | '000D' ws | '0009' ws

*/