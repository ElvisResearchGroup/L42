reuse [AdamTowel]
LoadJ=Load:{reuse[JavaServer]}
JServer=LoadJ(slaveName=S"javaServer{}")
LoadGui=Load:{reuse[GuiBuilder]}
Gui=LoadGui(javaServer=JServer)

Pulse=Data:{
  Double rad
  Double power
  }
Vector=Data:{...}
Kind=Data:{
  Double topSpeed
  Double acc
  Double radius
  Double break
  S img
  }
PlayerKind={class method Kind ()=\(
  topSpeed=5\,acc=\"0.08",radius=20\,break=\"-0.15"
  img=S"https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_92x30dp.png")}
RatKind={class method Kind ()=\(
  topSpeed=2\,acc=\"0.03",radius=25\,break=\"-0.2"
  img=S"rat.png")}

Map=Organize:{...}
AI={interface  method Pulse (read Map.Env that, mut Random r) }
PulseAI=Data:{...}
DriftAI=Data:{[AI]  method (that,r)=Pulse(rad=Vector.randomRad(r),power=1Double)}
ChaseAI=Data:{...}
Impact={class method Bool (read Map.Entity a, read Map.Entity b)=(
  dx=a.pos().x()-b.pos().x()
  dy=a.pos().y()-b.pos().y()
  r=a.kind().radius()+b.kind().radius()
  (dx*dx)+(dy*dy) <= r*r
  )}
EntityTrait=Trait:{...}
Player=Class:Data:EntityTrait['MyAI=>PulseAI]:{
  class method mut This()=This(
    ai=PulseAI(left=Bool.false(),right=Bool.false(),up=Bool.false(),down=Bool.false(),text=S"")
    pos=Vector(x=35\,y=100\)
    speed=Vector(x=0\,y=0\)
    kind=PlayerKind()
    text=S""
    )
  }
Rat=Class:Data:EntityTrait['MyAI=>ChaseAI]:{
  class method mut This(Double x,Double y)=This(
    ai=ChaseAI()
    pos=Vector(x=x,y=y)
    speed=Vector(x=0\,y=0\)
    kind=RatKind()
    text=S""
    )
  }

Model=Data:JServer.Handler:{...}
Main={...}