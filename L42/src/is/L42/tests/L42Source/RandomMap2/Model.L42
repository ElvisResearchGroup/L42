mut Math.Random r
mut JServer j
var Camera c
Size side=64Size//256?
Double sideD=64Double
Camera=Data:{
  Double x,Double y,Double z
  method S toMsg()=S"%this.x();%this.y();%this.z()"
  }
read method Double <=(Double that)=that.max(0.5\).min(this.sideD()-1.5\)
class method mut This #$of()=This(
  r=Math.Random(seed=12\)//Math.Random.#$random(), //10 has a lake
  j=JServer.#$of(),
  c=Camera(x=25\,y=25\,z=25\))

@JServer.Handler mut method Void ping(S msg)=void

Point=Data:{Size x,Size y,Size z=0Size}
Points=Collection.list(Point)

RandomMap=Data:{...}
@JServer.Handler mut method Void start(S msg)=(
  map=RandomMap(
    r=this.#r(),
    waterLevel=5\,rockLevel=60\,mountainLevel=75\)
  map.heightMap()
  //map.makeGrass()
  //map.makeTrees()
  //map.markRocks()
  //map.#map().noUnderZero()
  this.#j().submitEvent(key='Example.SetMap, id=S"",msg=map.msg())
  this.#j().submitEvent(key='Example.ChangeScreen, id='Game, msg=S"0")
  whoops Message.Guard
  )
@JServer.Handler mut method Void pressed(S msg)=(
  if msg==S"Left" (this.c(\c.with(x=this<=\x-\"0.1")))
  if msg==S"Right" (this.c(\c.with(x=this<=\x+\"0.1")))
  if msg==S"Up" (this.c(\c.with(y=this<=\y-\"0.1")))
  if msg==S"Down" (this.c(\c.with(y=this<=\y+\"0.1")))
  if msg==S"q" (this.c(\c.with(z=this<=\z-\"0.1")))
  if msg==S"a" (this.c(\c.with(z=this<=\z+\"0.1")))
  this.#j().submitEvent(key='Example.SetCamera, id=S"", msg=this.c().toMsg())
  whoops Message.Guard
  )
